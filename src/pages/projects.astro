---
import Layout from "../layouts/Layout.astro";
import "../styles/global.css";
import Footer from "../components/footer.astro";
import MobileHeader from "../components/mobileHeader.astro";
import MobileDropdown from "../components/mobileDropdown.astro";
import DesktopNavbar from "../components/desktopNavbar.astro";
import { execSync } from "child_process";

const commit = execSync("git rev-parse --short HEAD").toString().trim();
---

<Layout title="Projects - Aayan Shaikh">
  <div
    class="flex flex-col min-h-screen bg-white dark:bg-slate-900 text-slate-900 dark:text-white"
  >
    <MobileHeader />

    <MobileDropdown />

    <div class="flex flex-1">
      <DesktopNavbar />

      <!-- MAIN CONTENT HERE !!-->  
      <main class="flex-1">
        <section class="w-full text-center mt-16">
          <h1 class="text-5xl sm:text-8xl font-bold fade-seq">projects.</h1>
          <p class="text-base sm:text-lg mt-4 opacity-80 text-gray-500 fade-seq">
            Tap on the squares for more details on the project.
          </p>
        </section> 

        <section class="max-w-6xl mx-auto mt-12 px-6">
          <div class="projects-grid grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- x-70 hotas -->
            <div 
              class="project-item relative cursor-pointer overflow-hidden rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"
              data-title="X-70 HOTAS"
              data-images='["/x-70/pic1.png", "/x-70/pic2.png", "/x-70/Screenshot 2025-06-30 220043.png", "/x-70/Screenshot 2025-06-30 220137.png", "/x-70/Screenshot 2025-06-30 221005.png", "/x-70/Screenshot 2025-06-30 221251.png", "/x-70/z_lastimage.png"]'
              data-description="A throttle and joystick HOTAS system designed from the ground up. Modelled after the X-56 HOTAS by Logitech.
                        <br>
                                    <br>  The X-70 HOTAS is a flight control system designed for use in flight sims and space sims. HOTAS stands for Hands on Throttle and Stick, and they are used to control planes in flight simulators just like how Airbus pilots and fighter pilots use a joystick to control the plane's movements. I designed both the throttle and the joystick in this project, down to the very mechanism that their motion relies on. The X-70 is highly customizable and has a bunch of useful features that increase realism, including landing gear and flap change levers, various customizable switches, and a touchscreen display that can be customized to activate more features and display data.

                                    <br>  I was motivated to make this project mainly by my own interest in flight sims but also due to the fact that there arent many HOTAS systems on the market right now that have a comparable amount of features for a reasonable price. For instance, the Turtle Beach VelocityOne flightdeck goes for around $500 CAD, which isnt very affordable. There is a lack of a affordable mid series detached HOTAS system that is still capable and reliable.
                                    <br>
                                    <br>  I journalled this project extensively on Github, just look for the file named JOURNAL.md and click them to see the entire engineering and build process
                                    <br> Check the GitHub for more info."
              data-github="https://github.com/AayanShaikh007/X-70-HOTAS"
            >
              <img src="/scalar-logo.png" alt="X-70 HOTAS" class="project-image w-full h-64 object-cover transition-transform duration-300 hover:scale-110" />
              <div class="project-info absolute bottom-0 left-0 right-0 bg-linear-to-t from-black/80 to-transparent p-4">
                <h3 class="text-xl font-bold text-white">X-70 HOTAS</h3>  
                <p class="text-sm text-white/90 mt-1">A fully custom throttle and joystick HOTAS system. Modelled after the X-56 HOTAS.</p>
              </div>
            </div>

            <!-- Multicopter Drone -->
            <div 
              class="project-item relative cursor-pointer overflow-hidden rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"
              data-title="Multipurpose Autonomous Delivery Drone"
              data-images='["/drone/Screenshot 2025-08-16 165630.png", "/drone/Screenshot 2025-08-04 164121.png", "/drone/Screenshot 2025-08-04 164131.png", "/drone/Screenshot 2025-08-16 171514.png", "/drone/imagelast.png"]'
              data-description="A polished multipurpose drone designed to carry various payloads including thermal or regular cameras with gimbal. The goal is to create a drone that is both capable and purpose-flexible, as most commercial drones like DJI models are limited to single-purpose tasks.

<br> My interest in drones sparked in Grade 4 when I saw a DJI Phantom used for photography at a welcoming parade in Toronto. I've been intrigued by drones and their applications ever since. However, I find it frustrating that companies commercialize drones for single purposes. There are merits to creating drones that can handle multiple tasks such as FPV flying combined with casual photography to reduce consumer waste.

<br> Due to increasing traffic congestion in cities, I aim to prototype a delivery drone that could eventually be scaled for autonomous delivery of everyday essentials. The drone will be medium to large sized (250-400mm or 400+mm), featuring CAN bus-capable flight controllers like the Pixhawk 6C Mini, GNSS systems, and a 3D-printed PETG frame.

<br> Key features include: return-to-home, obstacle avoidance, autonomous flight-and-follow, autonomous address-based package delivery, and a DJI Dock-like auto-landing system. This project heavily leverages CAD design and 3D printing to create functional components with solid attachment points for payloads, including string-based attachment and package release mechanisms.

<br> This is an excellent learning opportunity to develop skills in CAD analysis, functional 3D printing, embedded systems, and autonomous flight algorithms. Check the JOURNAL.md file on GitHub to follow the entire engineering and build process.
<br> Check the GitHub for more info."
              data-github="https://github.com/AayanShaikh007/drone"
            >
              <img src="/scalar-logo.png" alt="Multipurpose Autonomous Delivery Drone" class="project-image w-full h-64 object-cover transition-transform duration-300 hover:scale-110" />
              <div class="project-info absolute bottom-0 left-0 right-0 bg-linear-to-t from-black/80 to-transparent p-4">
                <h3 class="text-xl font-bold text-white">Autonomous Delivery Drone</h3>  
                <p class="text-sm text-white/90 mt-1">Multipurpose drone with autonomous capabilities and payload delivery</p>
              </div>
            </div>

            <!-- KB-01: Mechanical Keyboard -->
            <div 
              class="project-item relative cursor-pointer overflow-hidden rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"
              data-title="KB-01: Mechanical Keyboard"
              data-images='["/kb-01/Screenshot 2025-06-17 155354.png", "/kb-01/real life.jpg", "/kb-01/Screenshot 2025-06-19 135428.png", "/kb-01/Screenshot 2025-06-19 140931.png"]'
              data-description="I've always wanted to make a mechanical keyboard, and after owning two proprietary keyboards, I had an idea of what features I wanted to incorporate in my final design. To begin, I love the OLED display in the high end steelseries keyboards, so that was a must-add. One of my keyboards, a Corsair K65, broke after I tried to fix a malfunctioning switch and damaged the board, shorting the traces for a few surrounding keys. It is due to this that I decided to make this keyboard hot-swappable, so that you can easily swap switches (mx and kalih). <br>  I extensively journalled this project on my github, just look for the file named JOURNAL.md and click them to see the entire engineering and build process.
<br> Check the GitHub for more info."
              data-github="https://github.com/AayanShaikh007/KB-01"
            >
              <img src="/scalar-logo.png" alt="KB-01: Mechanical Keyboard" class="project-image w-full h-64 object-cover transition-transform duration-300 hover:scale-110" />
              <div class="project-info absolute bottom-0 left-0 right-0 bg-linear-to-t from-black/80 to-transparent p-4">
                <h3 class="text-xl font-bold text-white">KB-01: Mechanical Keyboard</h3>  
                <p class="text-sm text-white/90 mt-1">Custom Keyboard Fully Engineered from scratch</p>
              </div>
            </div>

            <!-- Group: Stress-free Gatherings App -->
            <div 
              class="project-item relative cursor-pointer overflow-hidden rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"
              data-title="Group: Stress-free Gatherings App"
              data-images='["/group/Screenshot 2025-08-11 232536.png", "/group/Screenshot 2025-08-10 170137.png", "/group/Screenshot 2025-08-11 225610.png"]'
              data-description="An Expo-based mobile app that uses technology to bring people together by making gatherings less stressful to manage. Built with TypeScript, file-based routing, and modern Expo tooling.
<br> Check the GitHub for more info."
              data-github="https://github.com/AayanShaikh007/Group"
            >
              <img src="/scalar-logo.png" alt="Group: Stress-free Gatherings App" class="project-image w-full h-64 object-cover transition-transform duration-300 hover:scale-110" />
              <div class="project-info absolute bottom-0 left-0 right-0 bg-linear-to-t from-black/80 to-transparent p-4">
                <h3 class="text-xl font-bold text-white">Group</h3>  
                <p class="text-sm text-white/90 mt-1">Expo app for organizing gatherings</p>
              </div>
            </div>

            <!-- IEEE LED Heart PCB -->
            <div 
              class="project-item relative cursor-pointer overflow-hidden rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"
              data-title="IEEE LED Heart PCB"
              data-images='["/ieee heart/first image.png", "/ieee heart/Screenshot 2025-12-23 001953.png", "/ieee heart/Screenshot 2025-12-23 002541.png", "/ieee heart/Screenshot 2025-12-24 003941.png"]'
              data-description="A custom heart-shaped LED PCB designed in KiCad for IEEE. This project focuses on a clean schematic, sensible footprints, and an aesthetic heart-shaped board outline with LED lighting patterns.

<br> The repository provides the full KiCad project files: schematic (`.kicad_sch`), PCB layout (`.kicad_pcb`), and project metadata. It serves as a learning and showcase build for PCB design workflows, from schematic capture to layout and manufacturing preparation.

<br> Explore the KiCad files to see net organization, LED placement strategies, and board constraints. The commit history documents incremental design changes and iteration.
<br> Check the GitHub for more info."
              data-github="https://github.com/AayanShaikh007/IEEE-LED-Heart-PCB"
            >
              <img src="/scalar-logo.png" alt="IEEE LED Heart PCB" class="project-image w-full h-64 object-cover transition-transform duration-300 hover:scale-110" />
              <div class="project-info absolute bottom-0 left-0 right-0 bg-linear-to-t from-black/80 to-transparent p-4">
                <h3 class="text-xl font-bold text-white">IEEE LED Heart PCB</h3>  
                <p class="text-sm text-white/90 mt-1">KiCad-designed heart-shaped PCB with LEDs</p>
              </div>
            </div>

            <!-- SUD- Smart Underwriting Dashboard (HTN Federato) -->
            <div 
              class="project-item relative cursor-pointer overflow-hidden rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"
              data-title="SUD- Smart Underwriting Dashboard"
              data-images='["/SUD/Screenshot 2025-09-14 073614.png", "/SUD/Screenshot 2025-09-14 073650.png", "/SUD/Screenshot 2025-09-14 073700.png", "/SUD/Screenshot 2025-09-16 220134.png", "/SUD/Screenshot 2025-09-18 170258.png", "/SUD/Screenshot 2025-09-18 170312.png"]'
              data-description="A hackathon project (Hack the North 2025) re-imagining the RiskOps landing page for insurance underwriters. The Smart Underwriting Dashboard uses AI to score submissions against a carrier's appetite, surfaces high-value risks first, and provides adjustable parameters and portfolio analytics.

    <br> How itâ€™s used: AI reviews each insurance submission to determine fit within appetite and assesses risk, delivering a 0-100 score to accelerate underwriter workflow. The dashboard includes tuning pages for appetite parameters and an adaptive portfolio view showing performance metrics (policies, payouts, customers, etc.).
  <br> Check the GitHub for more info."
              data-github="https://github.com/AayanShaikh007/htnfederato"
            >
              <img src="/scalar-logo.png" alt="Smart Underwriting Dashboard" class="project-image w-full h-64 object-cover transition-transform duration-300 hover:scale-110" />
              <div class="project-info absolute bottom-0 left-0 right-0 bg-linear-to-t from-black/80 to-transparent p-4">
                <h3 class="text-xl font-bold text-white">SUD- Smart Underwriting Dashboard</h3>  
                <p class="text-sm text-white/90 mt-1">AI-accelerated RiskOps for insurance underwriting</p>
              </div>
            </div>

            <!-- H2@Home: Decentralized Hydrogen Generation System -->
            <div 
              class="project-item relative cursor-pointer overflow-hidden rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"
              data-title="H2@Home (Guelph Engineering Competition)"
              data-images='["/H2aHome/awdad.jpg", "/H2aHome/IMG_20251116_193630_775.jpg", "/H2aHome/IMG_20251116_193647_242.jpg"]'
              data-description="Automation and monitoring software for a decentralized hydrogen generation system. Guelph Engineering Competition 2025 - Gold (1st Place).

<br> Built a real-time analytics and control dashboard in React + JavaScript with Firebase over WiFi: live data visualization, component state mapping; improved insight speed by ~70%.

<br> Programmed ESP32 in C++ for GPIO/ADC integration with relays, gas sensors, and safety-trigger logic across 5+ hardware components.

<br> Stack: C++, JavaScript, React, Firebase, ESP32, IoT. (Nov. 2025)
<br> Check the GitHub for more info."
              data-github="https://github.com/AayanShaikh007/h2atHome"
            >
              <img src="/scalar-logo.png" alt="H2@Home" class="project-image w-full h-64 object-cover transition-transform duration-300 hover:scale-110" />
              <div class="project-info absolute bottom-0 left-0 right-0 bg-linear-to-t from-black/80 to-transparent p-4">
                <h3 class="text-xl font-bold text-white">H2@Home (Guelph Engineering Competition)</h3>  
                <p class="text-sm text-white/90 mt-1">Realtime IoT dashboard + ESP32 control</p>
              </div>
            </div>
            
            <!-- Splitboard: Wireless Ergodox-style Keyboard -->
            <div 
              class="project-item relative cursor-pointer overflow-hidden rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"
              data-title="Splitboard: Wireless Ergodox-style Keyboard"
              data-images='["/splitboard/Screenshot 2025-08-04 044314.png", "/splitboard/Screenshot 2025-08-04 034846.png", "/splitboard/Screenshot 2025-08-04 044135.png", "/splitboard/Screenshot 2025-08-04 044746.png"]'
              data-description="A DIY split keyboard modelled after the Ergodox with wireless Bluetooth connectivity and on-board battery charging/management.

<br> Designed for ergonomics and portability: two independent halves that can be arranged freely. Incorporates RGB lighting and Kailh hotswap sockets, with a refined case (low-profile walls ~3mm) and a voronoi pattern underside.

<br> See the repo for CAD, PCB, firmware, and a detailed BOM along with design notes in the journal.
<br> Check the GitHub for more info."
              data-github="https://github.com/AayanShaikh007/splitboard"
            >
              <img src="/scalar-logo.png" alt="Splitboard: Wireless Ergodox-style Keyboard" class="project-image w-full h-64 object-cover transition-transform duration-300 hover:scale-110" />
              <div class="project-info absolute bottom-0 left-0 right-0 bg-linear-to-t from-black/80 to-transparent p-4">
                <h3 class="text-xl font-bold text-white">Splitboard</h3>  
                <p class="text-sm text-white/90 mt-1">Wireless Ergodox-style split keyboard</p>
              </div>
            </div>

            <!-- Sweatpad: FPS Hackpad -->
            <div 
              class="project-item relative cursor-pointer overflow-hidden rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"
              data-title="Sweatpad: FPS Hackpad"
              data-images='["/sweatpad/Screenshot 2025-06-07 163622.png", "/sweatpad/Screenshot 2025-06-07 154958.png", "/sweatpad/Screenshot 2025-06-07 163648.png", "/sweatpad/Screenshot 2025-06-13 163835.png"]'
              data-description="A compact 16-key gaming hackpad focused on ergonomics, with RGB lighting and an OLED display. Built around SEEEDUINO XIAO RP2040, MX-style switches, 1N4148 diodes, SK6812 MINI-E LEDs, and DSA keycaps.

<br> The repo includes CAD, PCB, firmware, and a BOM, plus notes on design constraints (e.g., 100x100 mm PCB restriction) and case adjustments.
<br> Check the GitHub for more info."
              data-github="https://github.com/AayanShaikh007/sweatpad"
            >
              <img src="/scalar-logo.png" alt="Sweatpad: FPS Hackpad" class="project-image w-full h-64 object-cover transition-transform duration-300 hover:scale-110" />
              <div class="project-info absolute bottom-0 left-0 right-0 bg-linear-to-t from-black/80 to-transparent p-4">
                <h3 class="text-xl font-bold text-white">Sweatpad</h3>  
                <p class="text-sm text-white/90 mt-1">Ergonomic FPS hackpad with RGB + OLED</p>
              </div>
            </div>

            <!-- Mini Waymo Car -->
            <div 
              class="project-item relative cursor-pointer overflow-hidden rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"
              data-title="Mini Waymo Car"
              data-images='["/miniwaymo/Screenshot 2026-01-11 011526.png"]'
              data-description="A miniature autonomous-style vehicle with ultrasonic object avoidance. Powertrain uses dual N20 DC motors driven by an Adafruit DRV8833; chassis composed of breadboards, zip ties, and cardboard. Attempted Pi Zero-based computer vision; partial success with obstacle response and movement.

<br> See README for build notes, schematic references, and a demo link showing the vehicle responding to obstructions.
<br> Check the GitHub for more info."
              data-github="https://github.com/AayanShaikh007/mini-waymo"
            >
              <img src="/scalar-logo.png" alt="Mini Waymo Car" class="project-image w-full h-64 object-cover transition-transform duration-300 hover:scale-110" />
              <div class="project-info absolute bottom-0 left-0 right-0 bg-linear-to-t from-black/80 to-transparent p-4">
                <h3 class="text-xl font-bold text-white">Mini Waymo</h3>  
                <p class="text-sm text-white/90 mt-1">Ultrasonic object-avoidance vehicle</p>
              </div>
            </div>

            <!-- Head Tracking Mouse / Vision -->
            <div 
              class="project-item relative cursor-pointer overflow-hidden rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"
              data-title="Head Tracking Mouse / Vision"
              data-images='["/facetracker/OpenCV-open-source-new-version-released.jpg"]'
              data-description="Hands-free cursor control using computer vision to track head movements and detect mouth openings via a webcam. Translates facial landmarks into mouse movements and clicks using OpenCV, MediaPipe, PyAutoGUI, and Keyboard.

<br> See the release and README for setup instructions and usage details.
<br> Check the GitHub for more info."
              data-github="https://github.com/AayanShaikh007/Visioneersubmission"
            >
              <img src="/scalar-logo.png" alt="Head Tracking Mouse / Vision" class="project-image w-full h-64 object-cover transition-transform duration-300 hover:scale-110" />
              <div class="project-info absolute bottom-0 left-0 right-0 bg-linear-to-t from-black/80 to-transparent p-4">
                <h3 class="text-xl font-bold text-white">Head Tracking Mouse</h3>  
                <p class="text-sm text-white/90 mt-1">Computer-vision hands-free cursor control</p>
              </div>
            </div>

            <!-- Voronoi Mouse -->
            <div 
              class="project-item relative cursor-pointer overflow-hidden rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"
              data-title="Voronoi Mouse"
              data-images='["/mouse/Screenshot 2025-07-29 155358.png", "/mouse/Screenshot 2025-07-29 184200.png", "/mouse/Screenshot 2025-07-29 195925.png"]'
              data-description="A custom 3D-modelled mouse with a breathable voronoi design for comfort during long use. The build journal documents iterative design steps from base outline and low-poly form to button mechanism and final ergonomic tweaks.
<br> Check the GitHub for more info."
              data-github="https://github.com/AayanShaikh007/mouse"
            >
              <img src="/scalar-logo.png" alt="Voronoi Mouse" class="project-image w-full h-64 object-cover transition-transform duration-300 hover:scale-110" />
              <div class="project-info absolute bottom-0 left-0 right-0 bg-linear-to-t from-black/80 to-transparent p-4">
                <h3 class="text-xl font-bold text-white">Voronoi Mouse</h3>  
                <p class="text-sm text-white/90 mt-1">Breathable, ergonomic mouse design</p>
              </div>
            </div>

            

          </div>
        </section>
      </main>
    </div>

    <Footer commit={commit} />
  </div>

  <!-- popup -->
  <div id="popup" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
    <div id="popupPanel" class="bg-white dark:bg-slate-800 rounded-lg p-8 max-w-2xl mx-4 relative max-h-[85vh] overflow-y-auto">
      <button id="closePopup" class="absolute top-4 right-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 text-2xl">&times;</button>
      <div id="popupContent">
      </div>
    </div>
  </div>

  <!-- full-size image viewer -->
  <div id="imageViewer" class="fixed inset-0 bg-black/90 hidden items-center justify-center z-60">
    <button id="closeImageViewer" class="absolute top-4 right-4 text-white hover:text-gray-300 text-4xl z-70">&times;</button>
    <img id="fullSizeImage" src="" alt="Full size" class="max-w-[95vw] max-h-[95vh] object-contain" />
  </div>
</Layout> 

<style is:global>
  /* Always subtle scrollbar for image gallery */
  /* WebKit (Chrome, Edge, Safari) */
  .image-gallery::-webkit-scrollbar {
    height: 6px;
  }

  .image-gallery::-webkit-scrollbar-track {
    background: transparent;
  }

  .image-gallery::-webkit-scrollbar-thumb {
    background: rgba(148, 163, 184, 0.15); /* slate-300 at low opacity */
    border-radius: 3px;
  }

  .image-gallery::-webkit-scrollbar-thumb:hover {
    background: rgba(148, 163, 184, 0.25);
  }

  /* Firefox */
  .image-gallery {
    scrollbar-width: thin;
    scrollbar-color: rgba(148, 163, 184, 0.15) transparent;
  }

  @keyframes cardEnter {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .card-enter {
    animation: cardEnter 320ms ease-out forwards;
    will-change: transform, opacity;
  }

  @keyframes popupFadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes popupScaleIn {
    from { transform: scale(0.97); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
  }

  .animate-popup-overlay {
    animation: popupFadeIn 180ms ease-out;
  }

  .animate-popup-panel {
    animation: popupScaleIn 200ms ease-out;
  }
</style>

<script>
  function openPopup(projectData: { title: string; description: string; github: string; images: string[] }) {
    const popup = document.getElementById('popup');
    const popupContent = document.getElementById('popupContent');
    const popupPanel = document.getElementById('popupPanel');
    
    if (popup && popupContent && popupPanel) {
      let imagesHTML = '';
      if (projectData.images && projectData.images.length > 0) {
        imagesHTML = `
          <div class="image-gallery mb-6 overflow-x-auto">
            <div class="flex gap-4 pb-2">
              ${projectData.images.map((img, index) => `
                <img src="${img}" alt="Project image ${index + 1}" class="h-64 w-96 object-cover rounded-lg flex-shrink-0 cursor-pointer hover:opacity-80 transition-opacity gallery-image" />
              `).join('')}
            </div>
          </div>
        `;
      }
      
      popupContent.innerHTML = `
        <h2 class="text-3xl font-bold mb-4 text-slate-900 dark:text-white">${projectData.title}</h2>
        ${imagesHTML}
        <p class="text-lg text-slate-700 dark:text-slate-300 mb-6">${projectData.description}</p>
        
        <div class="border-t border-slate-200 dark:border-slate-700 pt-4">
          <a 
            href="${projectData.github}" 
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center gap-2 text-blue-600 dark:text-blue-400 hover:underline transition-all duration-200"
          >
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd" />
            </svg>
            View on GitHub
          </a>
        </div>
      `;
      popup.classList.remove('hidden');
      popup.classList.add('flex', 'animate-popup-overlay');
      popupPanel.classList.add('animate-popup-panel');
      // clean up animation classes after they run
      setTimeout(() => {
        popup.classList.remove('animate-popup-overlay');
        popupPanel.classList.remove('animate-popup-panel');
      }, 220);
      
      // Add click handlers to gallery images for full-size view
      setTimeout(() => {
        document.querySelectorAll('.gallery-image').forEach((img) => {
          img.addEventListener('click', (e) => {
            e.stopPropagation();
            const imageViewer = document.getElementById('imageViewer');
            const fullSizeImage = document.getElementById('fullSizeImage');
            if (imageViewer && fullSizeImage) {
              fullSizeImage.setAttribute('src', (img as HTMLImageElement).src);
              imageViewer.classList.remove('hidden');
              imageViewer.classList.add('flex');
            }
          });
        });
      }, 0);
    }
  }

  document.getElementById('closePopup')?.addEventListener('click', () => {
    const popup = document.getElementById('popup');
    if (popup) {
      popup.classList.add('hidden');
      popup.classList.remove('flex');
    }
  });

  // Close popup when clicking outside
  document.getElementById('popup')?.addEventListener('click', (e) => {
    if (e.target === document.getElementById('popup')) {
      const popup = document.getElementById('popup');
      if (popup) {
        popup.classList.add('hidden');
        popup.classList.remove('flex');
      }
    }
  });

  // Close image viewer
  document.getElementById('closeImageViewer')?.addEventListener('click', () => {
    const imageViewer = document.getElementById('imageViewer');
    if (imageViewer) {
      imageViewer.classList.add('hidden');
      imageViewer.classList.remove('flex');
    }
  });

  // Close image viewer when clicking outside the image
  document.getElementById('imageViewer')?.addEventListener('click', (e) => {
    if (e.target === document.getElementById('imageViewer')) {
      const imageViewer = document.getElementById('imageViewer');
      if (imageViewer) {
        imageViewer.classList.add('hidden');
        imageViewer.classList.remove('flex');
      }
    }
  });

  // Close with ESC key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      const imageViewer = document.getElementById('imageViewer');
      const popup = document.getElementById('popup');
      
      // Close image viewer first if it's open
      if (imageViewer && !imageViewer.classList.contains('hidden')) {
        imageViewer.classList.add('hidden');
        imageViewer.classList.remove('flex');
      } 
      // Otherwise close the popup
      else if (popup && !popup.classList.contains('hidden')) {
        popup.classList.add('hidden');
        popup.classList.remove('flex');
      }
    }
  });

  // Preload cover images (first image of each project) on page load
  window.addEventListener('load', () => {
    const coverImages = new Set<string>();
    document.querySelectorAll('.project-item').forEach((item) => {
      const imagesStr = item.getAttribute('data-images') || '[]';
      try {
        const images = JSON.parse(imagesStr) as unknown;
        if (Array.isArray(images)) {
          // only care about first item if it's a string
          if (images.length > 0 && typeof images[0] === 'string') {
            coverImages.add(images[0]);
          }
          return;
        }
      } catch (e) {
        // Skip invalid JSON
      }
    });
    
    // Preload cover images
    coverImages.forEach((imageSrc: string) => {
      const img = new Image();
      img.src = imageSrc;
    });
    
    // Prefetch all other images in background with delay
    setTimeout(() => {
      const allImages = new Set<string>();
      document.querySelectorAll('.project-item').forEach((item) => {
        const imagesStr = item.getAttribute('data-images') || '[]';
        try {
          const parsed = JSON.parse(imagesStr) as unknown;
          if (Array.isArray(parsed)) {
            parsed.forEach((imageSrc) => {
              if (typeof imageSrc === 'string') {
                allImages.add(imageSrc);
              }
            });
          }
        } catch (e) {
          // Skip invalid JSON
        }
      });
      
      allImages.forEach((imageSrc: string) => {
        const img = new Image();
        img.src = imageSrc;
      });
    }, 1000); // Start prefetching 1 second after page load
  });

  // Staggered card entry animation
  window.addEventListener('load', () => {
    const cards = Array.from(document.querySelectorAll('.project-item'));
    cards.forEach((item, idx) => {
      const el = item as HTMLElement;
      el.style.opacity = '0';
      el.style.transform = 'translateY(10px)';
      el.style.willChange = 'transform, opacity';
      setTimeout(() => {
        el.classList.add('card-enter');
        // Clean up inline styles after animation completes
        setTimeout(() => {
          el.style.removeProperty('opacity');
          el.style.removeProperty('transform');
          el.style.removeProperty('will-change');
        }, 360);
      }, idx * 80);
    });
  });

  // Add click handlers to project items
  document.querySelectorAll('.project-item').forEach((item) => {
    item.addEventListener('click', () => {
      const imagesStr = item.getAttribute('data-images') || '[]';
      let images = [];
      try {
        images = JSON.parse(imagesStr);
      } catch (e) {
        images = [];
      }
      
      const projectData = {
        title: item.getAttribute('data-title') || 'Project',
        description: item.getAttribute('data-description') || 'No description available.',
        github: item.getAttribute('data-github') || 'https://github.com',
        images: images
      };
      openPopup(projectData);
    });
  });

  // Use first image in data-images as the cover on the grid
  document.querySelectorAll('.project-item').forEach((item) => {
    const imagesStr = item.getAttribute('data-images') || '[]';
    let images = [];
    try {
      images = JSON.parse(imagesStr);
    } catch (e) {
      images = [];
    }
    const cover = item.querySelector('.project-image');
    if (cover && images.length > 0 && typeof images[0] === 'string' && images[0].trim() !== '') {
      cover.setAttribute('src', images[0]);
    }
  });
</script>